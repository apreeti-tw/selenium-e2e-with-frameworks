pipeline{
    agent any

    stages{
        stage ('build'){
            steps{
                echo "building the application"
            }
        }

        stage ('test'){
             steps{
                echo "running unit tests"
             }
        }

        stage ('run-ui-tests'){
             steps{
                script {
                    withCredentials([usernamePassword(credentialsId: 'test-user', passwordVariable: 'PASSWORD', usernameVariable: 'USERNAME')]) {
                       sh "export PASSWORD=$PASSWORD"
                       sh "export USERNAME=$USERNAME"
                    }
                }
                sh "mvn test"
             }
        }

        stage ('release'){
             steps{
                echo "deploying to live"
             }
        }
    }
}
